Third Treaty of San Ildefonso     the third treaty of san ildefonso ( short for the preliminary and secret treaty between the french republic and his catholic majesty the king of spain , concerning the aggrandizement of his royal highness the infant duke of parma in italy and the retrocession of louisiana ) was a treaty between france and spain . in it , spain gave the territory of louisiana to france .